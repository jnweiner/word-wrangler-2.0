<!DOCTYPE html>
<html>
  <head>
    <script src="jquery-3.5.1.js"></script>
    <script src="words.js"></script>
    <title>Word Wrangler</title>
    <link rel="stylesheet" href="main.css">
    <link href="https://fonts.googleapis.com/css2?family=Rye&display=swap" rel="stylesheet">
  </head>
  <body>
    <header>
      <h1>WORD WRANGLER</h1>
      <h2>Time to wrangle some words!</h2>
    </header>
    <div class="options">
      <button class="scramble">Scramble master word again</button>
      <button class="reveal">Reveal hidden word</button>
      <button class="quit">Quit</button>
    </div>
    <div class="statusbar">
    </div>
    <div class="displaywords">
    </div>
    <div class="guess-space">
      <span class="guessaword">Guess a word: </span><input type="text" class="guess"/>
      <button class="submit">Submit!</button>
    </div>

    <script>
      $(document).ready(function() {

        // SET UP + FUNCTIONS

        let points = {
          player: 0,
          total: 0
        };

        function shuffle(word) {
          const chars = word.split('');
          for (let i = chars.length - 1; i > 0; i--) {
            let j = Math.floor(Math.random() * i);
            let temp = chars[i];
            chars[i] = chars[j];
            chars[j] = temp;
          }
          return chars.join('');
        };

        function calculateTotalPoints(answers) {
          let totalPoints = 0;
          answers.forEach(function(answer) {
            totalPoints += answer.length;
          });
          return totalPoints;
        };

        function displayWords(wordLength, answers) {
          let guessesToDisplay = [];
          correctGuesses.forEach(function(guess) {
            if (guess.length === wordLength) {
              guessesToDisplay.push(guess);
            }
          });

          let answerAmount = 0;
          answers.forEach(function(answer) {
            if (answer.length === wordLength) {
              answerAmount += 1;
            }
          });

          let n = 0;
          while (n < answerAmount) {
            let $word = $("<div class='word'></div>");
            if (n < guessesToDisplay.length) {
              $word.text(`${n + 1}) ${guessesToDisplay[n]}`);
            } else {
              $word.text(`${n + 1})`);
            }
            $word.appendTo(".displaywords");
            n += 1;
          }
        };

        function displayProgress(masterWord, answers) {
          let wordLength = 3;
          while (wordLength <= masterWord.length) {
            let $hiddenflag = $("<div class='hiddenflag'></div>");
            $hiddenflag.text(`HIDDEN ${wordLength}-LETTER WORDS`);
            $("<br>").appendTo(".displaywords");
            $hiddenflag.appendTo(".displaywords");
            displayWords(wordLength, answers);
            wordLength +=1;
          }
        };

        let currentLevel = 0;
        points.total = calculateTotalPoints(wordsAndAnswers[currentLevel].answers)
        let correctGuesses = [];
        let masterWord = wordsAndAnswers[currentLevel].word;
        let answers = wordsAndAnswers[currentLevel].answers;

        let $masterword = $('<div class="masterword"></div>');
        let $statusbar = $(".statusbar");
        $masterword.text(`LEVEL ${currentLevel + 1} -- ${shuffle(masterWord)}`);
        let $pointsDisplay = $('<div class="points"></div>');
        $pointsDisplay.text(`Your points: ${points.player} out of ${points.total} possible points`);

        $masterword.appendTo($statusbar);
        $pointsDisplay.appendTo($statusbar);

        displayProgress(masterWord, answers);

        $(".submit").on("click", function() {
          let $message = $("<div class='message'></div>")
          let playerGuess = $(".guess").val();
          if (correctGuesses.includes(playerGuess)) {
            $message.text("Already got that one, try again!");
          } else if (answers.includes(playerGuess)) {
            correctGuesses.push(playerGuess);
            $(".displaywords").html('');
            displayProgress(masterWord, answers);
            $message.text("Correct!");
          } else {
            $message.text("Try again!");
          }
          $message.appendTo(".guess-space");
          $(".guess").val('');
        });




      });
    </script>
  </body>
</html>